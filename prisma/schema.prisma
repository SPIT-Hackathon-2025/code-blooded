generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String     @id @default(uuid())
  username      String
  email         String
  password      String
  phone         String
  otp           String?
  otpExpiration DateTime?
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  teams         UserTeam[]
  commits       Commit[] 
}

model Team {
  id        String     @id @default(uuid())  
  name      String     @unique
  users     UserTeam[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  documents CodeDocument[]
}

model UserTeam {
  id     String @id @default(uuid())
  userId String
  teamId String
  role   Role   @default(VIEWER)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  team Team @relation(fields: [teamId], references: [id], onDelete: Cascade)
}

enum Role {
  EDITOR
  VIEWER
}

model CodeDocument {
  id        String   @id @default(uuid())  
  roomId    String   @unique 
  content   String 
  language  String 
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


// model User {
//   id            String     @id @default(auto()) @map("_id") @db.ObjectId
//   username      String
//   email         String    
//   password      String
//   phone         String
//   otp           String?
//   otpExpiration DateTime?
//   createdAt     DateTime   @default(now())
//   updatedAt     DateTime   @updatedAt
//   teams         UserTeam[]
// }
// //elecktron
// //gitt on before closing autocommits 
// model Team {
//   id        String     @id @default(auto()) @map("_id") @db.ObjectId
//   name      String
//   users     UserTeam[]
//   createdAt DateTime   @default(now())
//   updatedAt DateTime   @updatedAt
// }

// model UserTeam {
//   id     String @id @default(auto()) @map("_id") @db.ObjectId
//   userId String @db.ObjectId
//   teamId String @db.ObjectId
//   role   Role   @default(VIEWER)

//   user User @relation(fields: [userId], references: [id])
//   team Team @relation(fields: [teamId], references: [id])
// }

// enum Role {
//   EDITOR
//   VIEWER
// }

// model CodeDocument {
//   id        String   @id @default(auto()) @map("_id") @db.ObjectId
//   roomId    String   @unique 
//   content   String 
//   language  String 
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }
